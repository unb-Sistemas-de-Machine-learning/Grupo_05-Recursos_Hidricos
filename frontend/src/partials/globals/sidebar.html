<!-- /src/partials/globals/sidebar.html -->
<aside id="ap-sidebar"
  class="fixed inset-y-0 left-0 z-40 w-72 bg-white/90 dark:bg-[#0C1A2A]/90
         border-r border-black/5 dark:border-white/10 backdrop-blur-xl
         shadow-[0_30px_70px_-30px_rgba(0,0,0,.45)] flex flex-col overflow-hidden">

  <!-- Topo: Branding + Collapse -->
  <div class="flex items-center justify-between px-4 py-4">
    <a href="/index.html" class="inline-flex items-center gap-3">
      <img id="sb-logo-expanded"  src="/home/logo.png"            alt="AguaPrev" class="h-8 w-auto">
      <img id="sb-logo-collapsed" src="/home/logo_minimalist.png" alt="AguaPrev" class="h-8 w-auto hidden">
    </a>
    <button id="sb-collapse" class="rounded-lg p-2 hover:bg-black/5 dark:hover:bg-white/10" aria-label="Comprimir menu" title="Comprimir menu">
      <svg viewBox="0 0 24 24" class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M8 6l-6 6 6 6M16 18l6-6-6-6"/>
      </svg>
    </button>
  </div>

  <!-- Perfil (com overflow fix no colapsado) -->
  <div id="sb-profile" class="px-4 pb-3 min-h-0">
    <div class="sb-profile flex items-center gap-3 rounded-2xl border border-black/5 dark:border-white/10
                bg-white/70 dark:bg-white/5 px-3 py-3 overflow-hidden">
      <img id="sb-avatar" alt="Avatar" src="/src/assets/img/avatar-default.png"
           class="h-10 w-10 rounded-xl object-cover ring-1 ring-black/5 dark:ring-white/10 shrink-0">
      <div class="min-w-0 flex-1" data-sb-label>
        <p id="sb-name"  class="truncate text-sm font-semibold text-[#031E21] dark:text-white">Usuário</p>
        <p id="sb-email" class="truncate text-xs text-gray-600 dark:text-gray-300">email@exemplo.com</p>
      </div>
      <!-- atalho perfil -->
      <button id="sb-profile-btn" class="ml-auto sb-ctrl" title="Abrir perfil" aria-label="Abrir perfil">
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm7 9v-2a7 7 0 0 0-14 0v2"/></svg>
        <span data-sb-label>Perfil</span>
      </button>
    </div>
  </div>

  <!-- Busca -->
  <div class="px-3" data-sb-label>
    <div class="relative">
      <input type="search" placeholder="Buscar…" class="w-full rounded-xl px-10 py-2 text-sm
             bg-white dark:bg-white/10 border border-black/5 dark:border-white/10
             focus:outline-none focus:ring-2 focus:ring-[#0A5C67]">
      <svg class="w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 opacity-70" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <circle cx="11" cy="11" r="8"/><path d="m21 21-3.5-3.5"/>
      </svg>
    </div>
  </div>

  <!-- Navegação -->
  <nav class="px-3 py-3 space-y-1 flex-1 overflow-y-auto">
    <p class="sb-section" data-sb-label>Geral</p>

    <a href="/dashboard.html" class="sb-link" title="Visão geral" data-tooltip="Visão geral">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M3 12h7V3H3v9Zm0 9h7v-7H3v7Zm11 0h7v-9h-7v9ZM14 3v7h7V3h-7Z"/>
      </svg>
      <span data-sb-label>Visão geral</span>
    </a>

    <p class="sb-section" data-sb-label>Explorar</p>

    <a href="maps.html" class="sb-link" title="Mapas" data-tooltip="Mapas">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M3 6l6-2 6 2 6-2v14l-6 2-6-2-6 2V6z"/><path d="M9 4v14M15 6v14"/>
      </svg>
      <span data-sb-label>Mapas</span>
    </a>

    <a href="series.html" class="sb-link" title="Séries temporais" data-tooltip="Séries temporais">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M3 3v18h18"/><path d="M7 13l4-4 3 3 4-5"/>
      </svg>
      <span data-sb-label>Séries</span>
    </a>

    <a href="compare.html" class="sb-link" title="Comparar bacias" data-tooltip="Comparar bacias">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M4 4h6v16H4zM14 8h6v12h-6z"/>
      </svg>
      <span data-sb-label>Comparar</span>
    </a>

    <p class="sb-section" data-sb-label>Operacional</p>

    <a href="alerts.html" class="sb-link" title="Alertas" data-tooltip="Alertas">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M12 9v4"/><path d="M10.29 3.86 1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0Z"/><path d="M12 17h.01"/>
      </svg>
      <span data-sb-label>Alertas</span>
      <span class="sb-badge" aria-hidden="true">3</span>
    </a>

    <a href="reports.html" class="sb-link" title="Relatórios" data-tooltip="Relatórios">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M7 3h10a2 2 0 0 1 2 2v14l-5-3-5 3V5a2 2 0 0 1 2-2z"/>
      </svg>
      <span data-sb-label>Relatórios</span>
    </a>

    <!-- NOVO: Tutorial (substitui Exportar/API) -->
    <a href="tutorials.html" class="sb-link" title="Tutorial" data-tooltip="Tutorial">
      <svg viewBox="0 0 24 24" class="sb-ico" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M4 19.5V6.5A2.5 2.5 0 0 1 6.5 4H20"/><path d="M6.5 6H20v14H6.5A2.5 2.5 0 0 1 4 17.5"/><path d="M8 10h8M8 14h6"/>
      </svg>
      <span data-sb-label>Tutorial</span>
    </a>
  </nav>

  <!-- Rodapé -->
  <div class="px-3 py-3 border-t border-black/5 dark:border-white/10 space-y-3 relative overflow-visible">

    <!-- Linha 1: Tema + Idioma -->
    <div class="ap-footer-row flex items-center justify-between gap-2">
      <!-- Tema (icone fica branco no dark) -->
      <button id="theme-toggle" class="sb-ctrl text-gray-800 dark:text-white" title="Tema" aria-label="Alternar tema">
        <svg id="icon-sun" class="w-4 h-4 hidden dark:inline" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="4"/><path d="M12 2v2m0 16v2m10-10h-2M4 12H2m15.54 6.46-1.41-1.41M7.87 7.87 6.46 6.46m0 11.08 1.41-1.41M16.13 7.87l1.41-1.41"/>
        </svg>
        <svg id="icon-moon" class="w-4 h-4 dark:hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
        </svg>
        <span data-sb-label> Tema</span>
      </button>

      <!-- Idioma -->
      <div class="relative overflow-visible flex-1">
        <button id="lang-toggle" class="sb-ctrl w-full justify-between text-gray-800 dark:text-white" aria-haspopup="true" aria-expanded="false" title="Idioma">
          <svg class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <circle cx="12" cy="12" r="9"/><path d="M3 12h18M12 3a15.3 15.3 0 0 0 0 18M12 3a15.3 15.3 0 0 1 0 18"/>
          </svg>
          <span data-sb-label>Idioma</span>
          <strong id="lang-current">PT-BR</strong>
        </button>

        <div id="lang-menu"
             class="sb-dropdown hidden absolute left-0 right-0 bottom-full mb-2 rounded-xl border border-black/10 dark:border-white/10
                    bg-white/95 dark:bg-[#0C1A2A]/95 backdrop-blur-xl shadow-lg overflow-auto max-h-60 z-50">
          <button class="sb-dd-item" data-lang="pt-BR">Português (BR)</button>
          <button class="sb-dd-item" data-lang="en">English</button>
          <button class="sb-dd-item" data-lang="es">Español</button>
        </div>
      </div>
    </div>

    <!-- Conta -->
    <div class="relative">
      <button id="account-toggle" class="sb-ctrl w-full justify-between text-gray-800 dark:text-white" aria-haspopup="true" aria-expanded="false" title="Conta e configurações">
        <svg class="sb-ico-collapsed w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="8" r="4"/><path d="M6 21v-2a6 6 0 0 1 12 0v2"/>
        </svg>
        <span class="inline-flex items-center gap-2">
          <img id="sb-mini-avatar" src="/src/assets/img/avatar-default.png" alt="" class="w-5 h-5 rounded-md object-cover hidden sm:inline">
          <span id="sb-mini-name" data-sb-label>Conta</span>
        </span>
        <svg class="w-4 h-4 opacity-80" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path d="M5.5 7.5l4.5 4.5 4.5-4.5"/></svg>
      </button>

      <div id="account-menu"
           class="sb-dropdown hidden absolute left-0 right-0 bottom-full mb-2 rounded-xl border border-black/10 dark:border-white/10
                  bg-white/95 dark:bg-[#0C1A2A]/95 backdrop-blur-xl shadow-lg overflow-hidden z-50">
        <button class="sb-dd-item" data-sb-action="profile">Perfil</button>
        <button class="sb-dd-item" data-sb-action="prefs">Preferências</button>
        <button class="sb-dd-item" data-sb-action="shortcuts">Atalhos</button>
        <button class="sb-dd-item" data-sb-action="help">Ajuda & Docs</button>
        <div class="h-px bg-black/10 dark:bg-white/10"></div>
        <button class="sb-dd-item text-red-600 dark:text-red-400" data-sb-action="signout">Sair</button>
      </div>
    </div>
  </div>
</aside>

<!-- Popover flutuante para modo colapsado -->
<div id="sb-popover" class="hidden fixed z-[70] w-[240px] rounded-xl border border-black/10 dark:border-white/10
     bg-white/95 dark:bg-[#0C1A2A]/95 backdrop-blur-xl shadow-2xl overflow-hidden"></div>
